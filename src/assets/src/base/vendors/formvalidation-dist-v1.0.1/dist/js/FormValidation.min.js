!function(e,t){typeof exports==='object'&&typeof module!=='undefined'?t(exports):typeof define==='function'&&define.amd?define(['exports'],t):(t((e.FormValidation={})))}(this,(function(e){"use strict";function t(e){let t=e.length,n=[[0,1,2,3,4,5,6,7,8,9],[0,2,4,6,8,1,3,5,7,9]],l=0,i=0;while(t--)i+=n[l][parseInt(e.charAt(t),10)],l=1-l;return i%10===0&&i>0}function n(e){let t=e.length,n=5;for(let l=0;l<t;l++)n=((n||10)*2%11+parseInt(e.charAt(l),10))%10;return n===1}function l(e,t = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'){let n=e.length,l=t.length,i=Math.floor(l/2);for(let a=0;a<n;a++)i=((i||l)*2%(l+1)+t.indexOf(e.charAt(a)))%l;return i===1}var i={luhn:t,mod11And10:n,mod37And36:l};function a(){return{fns:{},clear(){this.fns={}},emit(e,...t){(this.fns[e]||[]).map(e=>e.apply(e,t))},off(e,t){if(this.fns[e]){let n=this.fns[e].indexOf(t);n>=0&&this.fns[e].splice(n,1)}},on(e,t){(this.fns[e]=this.fns[e]||[]).push(t)}}}function r(){return{filters:{},add(e,t){(this.filters[e]=this.filters[e]||[]).push(t)},clear(){this.filters={}},execute(e,t,n){if(!this.filters[e]||!this.filters[e].length){return t}let l=t,i=this.filters[e],a=i.length;for(let e=0;e<a;e++)l=i[e].apply(l,n);return l},remove(e,t){this.filters[e]&&(this.filters[e]=this.filters[e].filter(e=>e!==t))}}}var o;!function(e){e.Invalid="Invalid";e.NotValidated="NotValidated";e.Valid="Valid";e.Validating="Validating"}(o||(o={}));var s=o;function d(e,t,n,l){let i=(n.getAttribute('type')||'').toLowerCase(),a=n.tagName.toLowerCase();switch(a){case 'textarea':return n.value;case 'select':let o=n;let r=o.selectedIndex;return r>=0?o.options.item(r).value:'';case 'input':if('radio'===i||'checkbox'===i){let e=l.filter(e=>e.checked).length;return e===0?'':e+''}else{return n.value};default:return''}}function c(e,t){let n=Array.isArray(t)?t:[t],l=e;n.forEach(e=>{l=l.replace('%s',e)});return l}function u(){let e=e=>{return parseFloat(`${e}`.replace(',','.'))};return{validate(t){let n=t.value;if(n===''){return{valid:!0}}let l=Object.assign({},{inclusive:!0},t.options),i=e(l.min),a=e(l.max);return l.inclusive?{message:t.l10n?c(l.message||t.l10n.between.default,[`${i}`,`${a}`]):l.message,valid:parseFloat(n)>=i&&parseFloat(n)<=a}:{message:t.l10n?c(l.message||t.l10n.between.notInclusive,[`${i}`,`${a}`]):l.message,valid:parseFloat(n)>i&&parseFloat(n)<a}}}}function m(){return{validate(e){return{valid:!0}}}}function f(e,t){if('function'===typeof e){return e.apply(this,t)}else if('string'===typeof e){let n=e;'()'===n.substring(n.length-2)&&(n=n.substring(0,n.length-2));let l=n.split('.'),i=l.pop(),a=window;for(let e of l)a=a[e];return typeof a[i]==='undefined'?null:a[i].apply(this,t)}}function p(){return{validate(e){let t=f(e.options.callback,[e]);return'boolean'===typeof t?{valid:t}:t}}}function g(){return{validate(e){let t='select'===e.element.tagName.toLowerCase()?e.element.querySelectorAll('option:checked').length:e.elements.filter(e=>e.checked).length,n=e.options.min?`${e.options.min}`:'',l=e.options.max?`${e.options.max}`:'',i=e.l10n?e.options.message||e.l10n.choice.default:e.options.message,a=!(n&&t<parseInt(n,10)||l&&t>parseInt(l,10));switch(!0){case !!n&&!!l:i=c(e.l10n?e.l10n.choice.between:e.options.message,[n,l]);break;case !!n:i=c(e.l10n?e.l10n.choice.more:e.options.message,n);break;case !!l:i=c(e.l10n?e.l10n.choice.less:e.options.message,l);break;default:break}return{message:i,valid:a}}}}let v={AMERICAN_EXPRESS:{length:[15],prefix:['34','37']},DANKORT:{length:[16],prefix:['5019']},DINERS_CLUB:{length:[14],prefix:['300','301','302','303','304','305','36']},DINERS_CLUB_US:{length:[16],prefix:['54','55']},DISCOVER:{length:[16],prefix:['6011','622126','622127','622128','622129','62213','62214','62215','62216','62217','62218','62219','6222','6223','6224','6225','6226','6227','6228','62290','62291','622920','622921','622922','622923','622924','622925','644','645','646','647','648','649','65']},ELO:{length:[16],prefix:['4011','4312','4389','4514','4573','4576','5041','5066','5067','509','6277','6362','6363','650','6516','6550']},FORBRUGSFORENINGEN:{length:[16],prefix:['600722']},JCB:{length:[16],prefix:['3528','3529','353','354','355','356','357','358']},LASER:{length:[16,17,18,19],prefix:['6304','6706','6771','6709']},MAESTRO:{length:[12,13,14,15,16,17,18,19],prefix:['5018','5020','5038','5868','6304','6759','6761','6762','6763','6764','6765','6766']},MASTERCARD:{length:[16],prefix:['51','52','53','54','55']},SOLO:{length:[16,18,19],prefix:['6334','6767']},UNIONPAY:{length:[16,17,18,19],prefix:['622126','622127','622128','622129','62213','62214','62215','62216','62217','62218','62219','6222','6223','6224','6225','6226','6227','6228','62290','62291','622920','622921','622922','622923','622924','622925']},VISA:{length:[16],prefix:['4']},VISA_ELECTRON:{length:[16],prefix:['4026','417500','4405','4508','4844','4913','4917']}};function h(){return{validate(e){if(e.value===''){return{meta:{type:null},valid:!0}}if(/[^0-9-\s]+/.test(e.value)){return{meta:{type:null},valid:!1}}let n=e.value.replace(/\D/g,'');if(!t(n)){return{meta:{type:null},valid:!1}}for(let t of Object.keys(v)){for(let l in v[t].prefix){if(e.value.substr(0,v[t].prefix[l].length)===v[t].prefix[l]&&v[t].length.indexOf(n.length)!==-1){return{meta:{type:t},valid:!0}}}}return{meta:{type:null},valid:!1}}}}function b(e,t,n,l){if(isNaN(e)||isNaN(t)||isNaN(n)){return!1}if(e<1e3||e>9999||t<=0||t>12){return!1}let i=[31,e%400===0||e%100!==0&&e%4===0?29:28,31,30,31,30,31,31,30,31,30,31];if(n<=0||n>i[t-1]){return!1}if(l===!0){let l=new Date,i=l.getFullYear(),a=l.getMonth(),r=l.getDate();return e<i||e===i&&t-1<a||e===i&&t-1===a&&n<r}return!0}function E(){let e=(e,t,n)=>{let l=t.indexOf('YYYY'),i=t.indexOf('MM'),a=t.indexOf('DD');if(l===-1||i===-1||a===-1){return null}let r=e.split(' '),o=r[0].split(n);if(o.length<3){return null}let s=new Date(parseInt(o[l],10),parseInt(o[i],10)-1,parseInt(o[a],10));if(r.length>1){let e=r[1].split(':');s.setHours(e.length>0?parseInt(e[0],10):0);s.setMinutes(e.length>1?parseInt(e[1],10):0);s.setSeconds(e.length>2?parseInt(e[2],10):0)}return s},t=(e,t)=>{let n=t.replace(/Y/g,'y').replace(/M/g,'m').replace(/D/g,'d').replace(/:m/g,':M').replace(/:mm/g,':MM').replace(/:S/,':s').replace(/:SS/,':ss'),l=e.getDate(),i=l<10?`0${l}`:l,a=e.getMonth()+1,r=a<10?`0${a}`:a,o=`${e.getFullYear()}`.substr(2),s=e.getFullYear(),d=e.getHours()%12||12,c=d<10?`0${d}`:d,u=e.getHours(),m=u<10?`0${u}`:u,f=e.getMinutes(),p=f<10?`0${f}`:f,g=e.getSeconds(),v=g<10?`0${g}`:g,h={H:`${u}`,HH:`${m}`,M:`${f}`,MM:`${p}`,d:`${l}`,dd:`${i}`,h:`${d}`,hh:`${c}`,m:`${a}`,mm:`${r}`,s:`${g}`,ss:`${v}`,yy:`${o}`,yyyy:`${s}`};return n.replace(/d{1,4}|m{1,4}|yy(?:yy)?|([HhMs])\1?|"[^"]*"|'[^']*'/g,e=>{return h[e]?h[e]:e.slice(1,e.length-1)})};return{validate(n){if(n.value===''){return{meta:{date:null},valid:!0}}let l=Object.assign({},{format:n.element&&n.element.getAttribute('type')==='date'?'YYYY-MM-DD':'MM/DD/YYYY',message:''},n.options),i=n.l10n?n.l10n.date.default:l.message,a={message:`${i}`,meta:{date:null},valid:!1},r=l.format.split(' '),o=r.length>1?r[1]:null,s=r.length>2?r[2]:null,d=n.value.split(' '),u=d[0],m=d.length>1?d[1]:null;if(r.length!==d.length){return a}let f=l.separator||(u.indexOf('/')!==-1?'/':(u.indexOf('-')!==-1?'-':(u.indexOf('.')!==-1?'.':'/')));if(f===null||u.indexOf(f)===-1){return a}let p=u.split(f),g=r[0].split(f);if(p.length!==g.length){return a}let v=p[g.indexOf('YYYY')],h=p[g.indexOf('MM')],E=p[g.indexOf('DD')];if(!/^\d+$/.test(v)||!/^\d+$/.test(h)||!/^\d+$/.test(E)||v.length>4||h.length>2||E.length>2){return a}let V=parseInt(v,10),x=parseInt(h,10),y=parseInt(E,10);if(!b(V,x,y)){return a}let w=new Date(V,x-1,y);if(o){let e=m.split(':');if(o.split(':').length!==e.length){return a}let t=e.length>0?(e[0].length<=2&&/^\d+$/.test(e[0])?parseInt(e[0],10):-1):0,n=e.length>1?(e[1].length<=2&&/^\d+$/.test(e[1])?parseInt(e[1],10):-1):0,l=e.length>2?(e[2].length<=2&&/^\d+$/.test(e[2])?parseInt(e[2],10):-1):0;if(t===-1||n===-1||l===-1){return a}if(l<0||l>60){return a}if(t<0||t>=24||s&&t>12){return a}if(n<0||n>59){return a}w.setHours(t);w.setMinutes(n);w.setSeconds(l)}let A=l.min instanceof Date?l.min:(l.min?e(l.min,g,f):w),H=l.max instanceof Date?l.max:(l.max?e(l.max,g,f):w),C=l.min instanceof Date?t(A,l.format):l.min,S=l.max instanceof Date?t(H,l.format):l.max;switch(!0){case !!C&&!S:return{message:c(n.l10n?n.l10n.date.min:i,C),meta:{date:w},valid:w.getTime()>=A.getTime()};case !!S&&!C:return{message:c(n.l10n?n.l10n.date.max:i,S),meta:{date:w},valid:w.getTime()<=H.getTime()};case !!S&&!!C:return{message:c(n.l10n?n.l10n.date.range:i,[C,S]),meta:{date:w},valid:w.getTime()<=H.getTime()&&w.getTime()>=A.getTime()};default:return{message:`${i}`,meta:{date:w},valid:!0}}}}}function V(){return{validate(e){let t='function'===typeof e.options.compare?e.options.compare.call(this):e.options.compare;return{valid:t===''||e.value!==t}}}}function x(){return{validate(e){return{valid:e.value===''||/^\d+$/.test(e.value)}}}}function y(){let e=(e,t)=>{let n=e.split(/"/),l=n.length,i=[],a='';for(let e=0;e<l;e++){if(e%2===0){let l=n[e].split(t),r=l.length;if(r===1)a+=l[0];else{i.push(a+l[0]);for(let e=1;e<r-1;e++)i.push(l[e]);a=l[r-1]}}else a+='"'+n[e],e<l-1&&(a+='"')}i.push(a);return i};return{validate(t){if(t.value===''){return{valid:!0}}let n=Object.assign({},{multiple:!1,separator:/[,;]/},t.options),l=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,i=n.multiple===!0||n.multiple==='true';if(i){let i=n.separator||/[,;]/,a=e(t.value,i);for(let e of a){if(!l.test(e)){return{valid:!1}}}return{valid:!0}}else{return{valid:l.test(t.value)}}}}}function w(){return{validate(e){if(e.value===''){return{valid:!0}}let t,n=e.options.extension?e.options.extension.toLowerCase().split(','):null,l=e.options.type?e.options.type.toLowerCase().split(','):null,i=window.File&&window.FileList&&window.FileReader;if(i){let i=e.element.files,a=i.length,r=0;if(e.options.maxFiles&&a>parseInt(`${e.options.maxFiles}`,10)){return{meta:{error:'INVALID_MAX_FILES'},valid:!1}}if(e.options.minFiles&&a<parseInt(`${e.options.minFiles}`,10)){return{meta:{error:'INVALID_MIN_FILES'},valid:!1}}let o={};for(let s=0;s<a;s++){r+=i[s].size;t=i[s].name.substr(i[s].name.lastIndexOf('.')+1);o={ext:t,file:i[s],size:i[s].size,type:i[s].type};if(e.options.minSize&&i[s].size<parseInt(`${e.options.minSize}`,10)){return{meta:Object.assign({},{error:'INVALID_MIN_SIZE'},o),valid:!1}}if(e.options.maxSize&&i[s].size>parseInt(`${e.options.maxSize}`,10)){return{meta:Object.assign({},{error:'INVALID_MAX_SIZE'},o),valid:!1}}if(n&&n.indexOf(t.toLowerCase())===-1){return{meta:Object.assign({},{error:'INVALID_EXTENSION'},o),valid:!1}}if(i[s].type&&l&&l.indexOf(i[s].type.toLowerCase())===-1){return{meta:Object.assign({},{error:'INVALID_TYPE'},o),valid:!1}}}if(e.options.maxTotalSize&&r>parseInt(`${e.options.maxTotalSize}`,10)){return{meta:Object.assign({},{error:'INVALID_MAX_TOTAL_SIZE',totalSize:r},o),valid:!1}}if(e.options.minTotalSize&&r<parseInt(`${e.options.minTotalSize}`,10)){return{meta:Object.assign({},{error:'INVALID_MIN_TOTAL_SIZE',totalSize:r},o),valid:!1}}}else{t=e.value.substr(e.value.lastIndexOf('.')+1);if(n&&n.indexOf(t.toLowerCase())===-1){return{meta:{error:'INVALID_EXTENSION',ext:t},valid:!1}}}return{valid:!0}}}}function A(){return{validate(e){if(e.value===''){return{valid:!0}}let t=Object.assign({},{inclusive:!0},e.options),n=parseFloat(`${t.min}`.replace(',','.'));return t.inclusive?{message:e.l10n?c(t.message||e.l10n.greaterThan.default,`${n}`):t.message,valid:parseFloat(e.value)>=n}:{message:e.l10n?c(t.message||e.l10n.greaterThan.notInclusive,`${n}`):t.message,valid:parseFloat(e.value)>n}}}}function H(){return{validate(e){let t='function'===typeof e.options.compare?e.options.compare.call(this):e.options.compare;return{valid:t===''||e.value===t}}}}function C(){return{validate(e){if(e.value===''){return{valid:!0}}let t=Object.assign({},{decimalSeparator:'.',thousandsSeparator:''},e.options),n=t.decimalSeparator==='.'?'\\.':t.decimalSeparator,l=t.thousandsSeparator==='.'?'\\.':t.thousandsSeparator,i=new RegExp(`^-?[0-9]{1,3}(${l}[0-9]{3})*(${n}[0-9]+)?$`),a=new RegExp(l,'g'),r=`${e.value}`;if(!i.test(r)){return{valid:!1}}l&&(r=r.replace(a,''));n&&(r=r.replace(n,'.'));let o=parseFloat(r);return{valid:!isNaN(o)&&isFinite(o)&&Math.floor(o)===o}}}}function S(){return{validate(e){if(e.value===''){return{valid:!0}}let t=Object.assign({},{ipv4:!0,ipv6:!0},e.options),n=/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\/([0-9]|[1-2][0-9]|3[0-2]))?$/,l=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*(\/(\d|\d\d|1[0-1]\d|12[0-8]))?$/;switch(!0){case t.ipv4&&!t.ipv6:return{message:e.l10n?t.message||e.l10n.ip.ipv4:t.message,valid:n.test(e.value)};case !t.ipv4&&t.ipv6:return{message:e.l10n?t.message||e.l10n.ip.ipv6:t.message,valid:l.test(e.value)};case t.ipv4&&t.ipv6:;default:return{message:e.l10n?t.message||e.l10n.ip.default:t.message,valid:n.test(e.value)||l.test(e.value)}}}}}function F(){return{validate(e){if(e.value===''){return{valid:!0}}let t=Object.assign({},{inclusive:!0},e.options),n=parseFloat(`${t.max}`.replace(',','.'));return t.inclusive?{message:e.l10n?c(t.message||e.l10n.lessThan.default,`${n}`):t.message,valid:parseFloat(e.value)<=n}:{message:e.l10n?c(t.message||e.l10n.lessThan.notInclusive,`${n}`):t.message,valid:parseFloat(e.value)<n}}}}function k(){return{validate(e){return{valid:e.value!==''}}}}function I(){return{validate(e){if(e.value===''){return{valid:!0}}let t=Object.assign({},{decimalSeparator:'.',thousandsSeparator:''},e.options),n=`${e.value}`;n.substr(0,1)===t.decimalSeparator?(n=`0${t.decimalSeparator}${n.substr(1)}`):n.substr(0,2)===`-${t.decimalSeparator}`&&(n=`-0${t.decimalSeparator}${n.substr(2)}`);let l=t.decimalSeparator==='.'?'\\.':t.decimalSeparator,i=t.thousandsSeparator==='.'?'\\.':t.thousandsSeparator,a=new RegExp(`^-?[0-9]{1,3}(${i}[0-9]{3})*(${l}[0-9]+)?$`),r=new RegExp(i,'g');if(!a.test(n)){return{valid:!1}}i&&(n=n.replace(r,''));l&&(n=n.replace(l,'.'));let o=parseFloat(n);return{valid:!isNaN(o)&&isFinite(o)}}}}function L(){return{validate(e){return f(e.options.promise,[e])}}}function N(){return{validate(e){if(e.value===''){return{valid:!0}}let t=e.options.regexp;if(t instanceof RegExp){return{valid:t.test(e.value)}}else{let n=t.toString(),l=e.options.flags?new RegExp(n,e.options.flags):new RegExp(n);return{valid:l.test(e.value)}}}}}function M(e,t){let n=e=>Object.keys(e).map(t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`).join('&');return new Promise((l,i)=>{let a=Object.assign({},{crossDomain:!1,headers:{},method:'GET',params:{}},t),r=Object.keys(a.params).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(a.params[e])}`).join('&'),o=e.indexOf('?'),s='GET'===a.method?`${e}${o?'?':'&'}${r}`:e;if(a.crossDomain){let e=document.createElement('script'),t=`___fetch${Date.now()}___`;window[t]=e=>{delete window[t],l(e)};e.src=`${s}${o?'&':'?'}callback=${t}`;e.async=!0;e.addEventListener('load',()=>{e.parentNode.removeChild(e)});e.addEventListener('error',()=>i);document.head.appendChild(e)}else{let e=new XMLHttpRequest;e.open(a.method,s);e.setRequestHeader('X-Requested-With','XMLHttpRequest');'POST'===a.method&&e.setRequestHeader('Content-Type','application/x-www-form-urlencoded');Object.keys(a.headers).forEach(t=>e.setRequestHeader(t,a.headers[t]));e.addEventListener('load',function(){l(JSON.parse(this.responseText))});e.addEventListener('error',()=>i);e.send(n(a.params))}})}function O(){let e={crossDomain:!1,data:{},headers:{},method:'GET',validKey:'valid'};return{validate(t){if(t.value===''){return Promise.resolve({valid:!0})}let n=Object.assign({},e,t.options),l=n.data;'function'===typeof n.data&&(l=n.data.call(this,t));'string'===typeof l&&(l=JSON.parse(l));l[n.name||t.field]=t.value;let i='function'===typeof n.url?n.url.call(this,t):n.url;return M(i,{crossDomain:n.crossDomain,headers:n.headers,method:n.method,params:l}).then(e=>{return Promise.resolve({message:e.message,meta:e,valid:`${e[n.validKey]}`==='true'})}).catch(e=>{return Promise.reject({valid:!1})})}}}function T(){return{validate(e){if(e.value===''){return{valid:!0}}let t=Object.assign({},{case:'lower'},e.options),n=(t.case||'lower').toLowerCase();return{message:t.message||(e.l10n?('upper'===n?e.l10n.stringCase.upper:e.l10n.stringCase.default):t.message),valid:'upper'===n?e.value===e.value.toUpperCase():e.value===e.value.toLowerCase()}}}}function Y(){let e=e=>{let t=e.length;for(let n=e.length-1;n>=0;n--){let l=e.charCodeAt(n);l>127&&l<=2047?t++:l>2047&&l<=65535&&(t+=2);l>=56320&&l<=57343&&n--}return`${t}`};return{validate(t){let n=Object.assign({},{trim:!1,utf8Bytes:!1},t.options),l=n.trim===!0||n.trim==='true'?t.value.trim():t.value;if(l===''){return{valid:!0}}let i=n.min?`${n.min}`:'',a=n.max?`${n.max}`:'',r=n.utf8Bytes?e(l):l.length,o=!0,s=t.l10n?n.message||t.l10n.stringLength.default:n.message;(i&&r<parseInt(i,10)||a&&r>parseInt(a,10))&&(o=!1);switch(!0){case !!i&&!!a:s=t.l10n?c(n.message||t.l10n.stringLength.between,[i,a]):n.message;break;case !!i:s=t.l10n?c(n.message||t.l10n.stringLength.more,parseInt(i,10)-1+''):n.message;break;case !!a:s=t.l10n?c(n.message||t.l10n.stringLength.less,parseInt(a,10)+1+''):n.message;break;default:break}return{message:s,valid:o}}}}function D(){let e={allowEmptyProtocol:!1,allowLocal:!1,protocol:'http, https, ftp'};return{validate(t){if(t.value===''){return{valid:!0}}let n=Object.assign({},e,t.options),l=n.allowLocal===!0||n.allowLocal==='true',i=n.allowEmptyProtocol===!0||n.allowEmptyProtocol==='true',a=n.protocol.split(',').join('|').replace(/\s/g,''),r=new RegExp("^(?:(?:"+a+")://)"+(i?'?':'')+"(?:\\S+(?::\\S*)?@)?"+"(?:"+(l?'':"(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})")+"(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])"+"(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}"+"(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))"+"|"+"(?:(?:[a-z\\u00a1-\\uffff0-9]-?)*[a-z\\u00a1-\\uffff0-9]+)"+"(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-?)*[a-z\\u00a1-\\uffff0-9])*"+"(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))"+(l?'?':'')+")"+"(?::\\d{2,5})?"+"(?:/[^\\s]*)?$","i");return{valid:r.test(t.value)}}}}var z={between:u,blank:m,callback:p,choice:g,creditCard:h,date:E,different:V,digits:x,emailAddress:y,file:w,greaterThan:A,identical:H,integer:C,ip:S,lessThan:F,notEmpty:k,numeric:I,promise:L,regexp:N,remote:O,stringCase:T,stringLength:Y,uri:D};class R{constructor(e,t){this.elements={};this.ee=a();this.filter=r();this.plugins={};this.results=new Map;this.validators={};this.form=e;this.fields=t}on(e,t){this.ee.on(e,t);return this}off(e,t){this.ee.off(e,t);return this}emit(e,...t){this.ee.emit(e,...t);return this}registerPlugin(e,t){if(this.plugins[e]){throw new Error(`The plguin ${e} is registered`)}t.setCore(this);t.install();this.plugins[e]=t;return this}deregisterPlugin(e){let t=this.plugins[e];t&&t.uninstall();delete this.plugins[e];return this}registerValidator(e,t){if(this.validators[e]){throw new Error(`The validator ${e} is registered`)}this.validators[e]=t;return this}registerFilter(e,t){this.filter.add(e,t);return this}deregisterFilter(e,t){this.filter.remove(e,t);return this}addField(e,t){let n=Object.assign({},{selector:'',validators:{}},t);this.fields[e]=this.fields[e]?{selector:n.selector||this.fields[e].selector,validators:Object.assign({},this.fields[e].validators,n.validators)}:n;this.elements[e]=this.queryElements(e);this.emit('core.field.added',{elements:this.elements[e],field:e,options:this.fields[e]});return this}removeField(e){if(!this.fields[e]){throw new Error(`The field ${e} validators are not defined. Please ensure the field is added first`)}let t=this.elements[e],n=this.fields[e];delete this.elements[e];delete this.fields[e];this.emit('core.field.removed',{elements:t,field:e,options:n});return this}validate(){this.emit('core.form.validating');return Promise.all(Object.keys(this.fields).map(e=>this.validateField(e))).then(e=>{switch(!0){case e.indexOf(s.Invalid)!==-1:this.emit('core.form.invalid');return Promise.resolve(s.Invalid);case e.indexOf(s.NotValidated)!==-1:this.emit('core.form.notvalidated');return Promise.resolve(s.NotValidated);default:this.emit('core.form.valid');return Promise.resolve(s.Valid)}})}validateField(e){let t=this.results.get(e);if(t===s.Valid||t===s.Invalid){return Promise.resolve(t)}this.emit('core.field.validating',e);let n=this.elements[e];if(n.length===0){this.emit('core.field.valid',e);return Promise.resolve(s.Valid)}let l=n[0].getAttribute('type');if('radio'===l||'checkbox'===l||n.length===1){return this.validateElement(e,n[0])}else{return Promise.all(n.map(t=>this.validateElement(e,t))).then(t=>{switch(!0){case t.indexOf(s.Invalid)!==-1:this.emit('core.field.invalid',e);this.results.set(e,s.Invalid);return Promise.resolve(s.Invalid);case t.indexOf(s.NotValidated)!==-1:this.emit('core.field.notvalidated',e);this.results.delete(e);return Promise.resolve(s.NotValidated);default:this.emit('core.field.valid',e);this.results.set(e,s.Valid);return Promise.resolve(s.Valid)}})}}validateElement(e,t){this.results.delete(e);let n=this.fields[e].validators,l=this.elements[e];this.emit('core.element.validating',{element:t,elements:l,field:e});return Promise.all(Object.keys(n).map(i=>{let a=this.filter.execute('validator-name',i,[i,e]),r=n[i];r.message=this.filter.execute('validator-message',r.message,[this.locale,e,a]);if(!this.validators[a]||r.enabled===!1){this.emit('core.validator.validated',{element:t,elements:l,field:e,result:this.normalizeResult(e,a,{valid:!0}),validator:a});return Promise.resolve(s.Valid)}let o=this.validators[a],d=this.getElementValue(e,t,a),c=this.filter.execute('field-should-validate',!0,[e,t,d,i]);if(!c){this.emit('core.validator.notvalidated',{element:t,elements:l,field:e,validator:i});return Promise.reject(s.NotValidated)}this.emit('core.validator.validating',{element:t,elements:l,field:e,validator:i});let u=o().validate({element:t,elements:l,field:e,l10n:this.localization,options:r,value:d}),m='function'===typeof u.then;if(m){return u.then(n=>{let a=this.normalizeResult(e,i,n);this.emit('core.validator.validated',{element:t,elements:l,field:e,result:a,validator:i});return a.valid?s.Valid:s.Invalid})}else{let n=this.normalizeResult(e,i,u);this.emit('core.validator.validated',{element:t,elements:l,field:e,result:n,validator:i});return Promise.resolve(n.valid?s.Valid:s.Invalid)}})).then(n=>{let i=n.indexOf(s.Invalid)===-1;this.emit('core.element.validated',{element:t,elements:l,field:e,valid:i});let a=t.getAttribute('type');('radio'===a||'checkbox'===a||l.length===1)&&this.emit(i?'core.field.valid':'core.field.invalid',e);return Promise.resolve(i?s.Valid:s.Invalid)}).catch(n=>{this.emit('core.element.notvalidated',{element:t,elements:l,field:e});return Promise.resolve(n)})}getElementValue(e,t,n){let l=d(this.form,e,t,this.elements[e]);return this.filter.execute('field-value',l,[l,e,t,n])}getElements(e){return this.elements[e]}getFields(){return this.fields}getFormElement(){return this.form}getPlugin(e){return this.plugins[e]}updateFieldStatus(e,t,n){let l=this.elements[e],i=l[0].getAttribute('type'),a='radio'===i||'checkbox'===i?[l[0]]:l;a.forEach(l=>this.updateElementStatus(e,l,t,n));switch(t){case s.NotValidated:this.emit('core.field.notvalidated',e);this.results.delete(e);break;case s.Validating:this.emit('core.field.validating',e);this.results.delete(e);break;case s.Valid:this.emit('core.field.valid',e);this.results.set(e,s.Valid);break;case s.Invalid:this.emit('core.field.invalid',e);this.results.set(e,s.Invalid);break}return this}updateElementStatus(e,t,n,l){let i=this.elements[e],a=this.fields[e].validators,r=l?[l]:Object.keys(a);switch(n){case s.NotValidated:r.forEach(n=>this.emit('core.validator.notvalidated',{element:t,elements:i,field:e,validator:n}));this.emit('core.element.notvalidated',{element:t,elements:i,field:e});break;case s.Validating:r.forEach(n=>this.emit('core.validator.validating',{element:t,elements:i,field:e,validator:n}));this.emit('core.element.validating',{element:t,elements:i,field:e});break;case s.Valid:r.forEach(n=>this.emit('core.validator.validated',{element:t,field:e,result:{message:a[n].message,valid:!0},validator:n}));this.emit('core.element.validated',{element:t,elements:i,field:e,valid:!0});break;case s.Invalid:r.forEach(n=>this.emit('core.validator.validated',{element:t,field:e,result:{message:a[n].message,valid:!1},validator:n}));this.emit('core.element.validated',{element:t,elements:i,field:e,valid:!1});break}return this}resetForm(e){Object.keys(this.fields).forEach(t=>this.resetField(t,e));this.emit('core.form.reset',{reset:e});return this}resetField(e,t){if(t){let t=this.elements[e],n=t[0].getAttribute('type');t.forEach(e=>{'radio'===n||'checkbox'===n?(e.removeAttribute('selected'),e.removeAttribute('checked')):e.setAttribute('value','')})}this.updateFieldStatus(e,s.NotValidated);this.emit('core.field.reset',{field:e,reset:t});return this}revalidateField(e){this.updateFieldStatus(e,s.NotValidated);return this.validateField(e)}disableValidator(e,t){return this.toggleValidator(!1,e,t)}enableValidator(e,t){return this.toggleValidator(!0,e,t)}updateValidatorOption(e,t,n,l){this.fields[e]&&this.fields[e].validators&&this.fields[e].validators[t]&&(this.fields[e].validators[t][n]=l);return this}destroy(){Object.keys(this.plugins).forEach(e=>this.plugins[e].uninstall());this.ee.clear();this.filter.clear();this.results.clear();this.plugins={};return this}setLocale(e,t){this.locale=e;this.localization=t;return this}queryElements(e){let t=this.fields[e].selector?('#'===this.fields[e].selector.charAt(0)?`[id="${this.fields[e].selector.substring(1)}"]`:this.fields[e].selector):`[name="${e}"]`;return[].slice.call(this.form.querySelectorAll(t))}normalizeResult(e,t,n){let l=this.fields[e].validators[t];return Object.assign({},n,{message:n.message||l.message||(this.localization&&this.localization[t]&&this.localization[t].default?this.localization[t].default:'')||`The field ${e} is not valid`})}toggleValidator(e,t,n){let l=this.fields[t].validators;n&&l&&l[n]?(this.fields[t].validators[n].enabled=e):n||Object.keys(l).forEach(n=>this.fields[t].validators[n].enabled=e);return this.updateFieldStatus(t,s.NotValidated,n)}}function P(e,t){let n=Object.assign({},{fields:{},locale:'en_US',plugins:{}},t),l=new R(e,n.fields);l.setLocale(n.locale,n.localization);Object.keys(n.plugins).forEach(e=>l.registerPlugin(e,n.plugins[e]));Object.keys(z).forEach(e=>l.registerValidator(e,z[e]));Object.keys(n.fields).forEach(e=>l.addField(e,n.fields[e]));return l}class q{constructor(e){this.opts=e}setCore(e){this.core=e;return this}install(){}uninstall(){}}var _={getFieldValue:d};class j extends q{constructor(e){super(e);this.opts=e||{};this.validatorNameFilter=this.getValidatorName.bind(this)}install(){this.core.registerFilter('validator-name',this.validatorNameFilter)}uninstall(){this.core.deregisterFilter('validator-name',this.validatorNameFilter)}getValidatorName(e,t){return this.opts[e]||e}}class X extends q{constructor(){super({});this.elementValidatedHandler=this.onElementValidated.bind(this);this.fieldValidHandler=this.onFieldValid.bind(this);this.fieldInvalidHandler=this.onFieldInvalid.bind(this);this.messageDisplayedHandler=this.onMessageDisplayed.bind(this)}install(){this.core.on('core.field.valid',this.fieldValidHandler).on('core.field.invalid',this.fieldInvalidHandler).on('core.element.validated',this.elementValidatedHandler).on('plugins.message.displayed',this.messageDisplayedHandler)}uninstall(){this.core.off('core.field.valid',this.fieldValidHandler).off('core.field.invalid',this.fieldInvalidHandler).off('core.element.validated',this.elementValidatedHandler).off('plugins.message.displayed',this.messageDisplayedHandler)}onElementValidated(e){e.valid&&(e.element.setAttribute('aria-invalid','false'),e.element.removeAttribute('aria-describedby'))}onFieldValid(e){let t=this.core.getElements(e);t&&t.forEach(e=>{e.setAttribute('aria-invalid','false'),e.removeAttribute('aria-describedby')})}onFieldInvalid(e){let t=this.core.getElements(e);t&&t.forEach(e=>e.setAttribute('aria-invalid','true'))}onMessageDisplayed(e){e.messageElement.setAttribute('role','alert');e.messageElement.setAttribute('aria-hidden','false');let t=this.core.getElements(e.field),n=t.indexOf(e.element),l=`js-fv-${e.field}-${n}-${Date.now()}-message`;e.messageElement.setAttribute('id',l);e.element.setAttribute('aria-describedby',l);let i=e.element.getAttribute('type');('radio'===i||'checkbox'===i)&&t.forEach(e=>e.setAttribute('aria-describedby',l))}}class G extends q{constructor(){super({});this.invalidElements=[];this.invalidFormHandler=this.onFormInvalid.bind(this);this.elementValidatedHandler=this.onElementValidated.bind(this);this.elementNotValidatedHandler=this.onElementNotValidated.bind(this)}install(){this.core.on('core.form.invalid',this.invalidFormHandler).on('core.element.validated',this.elementValidatedHandler).on('core.element.notvalidated',this.elementNotValidatedHandler)}uninstall(){this.invalidElements=[];this.core.off('core.form.invalid',this.invalidFormHandler).off('core.element.validated',this.elementValidatedHandler).off('core.element.notvalidated',this.elementNotValidatedHandler)}onElementValidated(e){let t=this.invalidElements.indexOf(e.element);e.valid&&t>=0?this.invalidElements.splice(t,1):!e.valid&&t===-1&&this.invalidElements.push(e.element)}onElementNotValidated(e){this.invalidElements.splice(this.invalidElements.indexOf(e.element),1)}onFormInvalid(){this.invalidElements.length&&this.invalidElements[0].focus()}}class U extends q{constructor(e){super(e);this.opts=Object.assign({},{html5Input:!1,prefix:'data-fv-'},e)}install(){let e=this.parseOptions();Object.keys(e).forEach(t=>this.core.addField(t,e[t]))}parseOptions(){let e=this.opts.prefix,t={},n=this.core.getFields(),l=this.core.getFormElement(),i=[].slice.call(l.querySelectorAll(`[name], [${e}field]`));i.forEach(n=>{let l=this.parseElement(n);if(!this.isEmptyOption(l)){let i=n.getAttribute('name')||n.getAttribute(`${e}field`);t[i]=Object.assign({},t[i],l)}});Object.keys(t).forEach(e=>{Object.keys(t[e].validators).forEach(l=>{t[e].validators[l].enabled=t[e].validators[l].enabled||!1,n[e]&&n[e].validators&&n[e].validators[l]&&Object.assign(t[e].validators[l],n[e].validators[l])})});return Object.assign({},n,t)}isEmptyOption(e){let t=e.validators;return Object.keys(t).length===0&&t.constructor===Object}parseElement(e){let t=new RegExp(`^${this.opts.prefix}([a-z0-9\-]+)(___)*([a-z0-9\-]+)*$`),n=e.attributes.length,l={},i=e.getAttribute('type');for(let a=0;a<n;a++){let n=e.attributes[a].name,r=e.attributes[a].value;if(this.opts.html5Input){switch(!0){case 'minlength'===n:l.stringLength=Object.assign({},{enabled:!0,min:parseInt(r,10)},l.stringLength);break;case 'maxlength'===n:l.stringLength=Object.assign({},{enabled:!0,max:parseInt(r,10)},l.stringLength);break;case 'pattern'===n:l.regexp=Object.assign({},{enabled:!0,regexp:r},l.regexp);break;case 'required'===n:l.notEmpty=Object.assign({},{enabled:!0},l.notEmpty);break;case 'type'===n&&'color'===r:l.color=Object.assign({},{enabled:!0,type:'hex'},l.color);break;case 'type'===n&&'email'===r:l.emailAddress=Object.assign({},{enabled:!0},l.emailAddress);break;case 'type'===n&&'url'===r:l.uri=Object.assign({},{enabled:!0},l.uri);break;case 'type'===n&&'range'===r:l.between=Object.assign({},{enabled:!0,max:parseFloat(e.getAttribute('max')),min:parseFloat(e.getAttribute('min'))},l.between);break;case 'min'===n&&i!=='date'&&i!=='range':l.greaterThan=Object.assign({},{enabled:!0,min:parseFloat(r)},l.greaterThan);break;case 'max'===n&&i!=='date'&&i!=='range':l.lessThan=Object.assign({},{enabled:!0,max:parseFloat(r)},l.lessThan);break;default:break}}let o=t.exec(n);if(o&&o.length===4){let e=this.toCamelCase(o[1]);l[e]=Object.assign({},o[3]?{[this.toCamelCase(o[3])]:r}:{enabled:''===r||'true'===r},l[e])}}return{validators:l}}toUpperCase(e){return e.charAt(1).toUpperCase()}toCamelCase(e){return e.replace(/-./g,this.toUpperCase)}}class W extends q{constructor(){super({});this.onValidHandler=this.onFormValid.bind(this)}install(){let e=this.core.getFormElement();if(e.querySelectorAll('[type="submit"][name="submit"]').length){throw new Error('Do not use `submit` for the name attribute of submit button')}this.core.on('core.form.valid',this.onValidHandler)}uninstall(){this.core.off('core.form.valid',this.onValidHandler)}onFormValid(){let e=this.core.getFormElement();e instanceof HTMLFormElement&&e.submit()}}class B extends q{constructor(e){super(e);this.opts=e||{};this.triggerExecutedHandler=this.onTriggerExecuted.bind(this)}install(){this.core.on('plugins.trigger.executed',this.triggerExecutedHandler)}uninstall(){this.core.off('plugins.trigger.executed',this.triggerExecutedHandler)}onTriggerExecuted(e){if(this.opts[e.field]){let t=this.opts[e.field].split(' ');for(let e of t){let t=e.trim();this.opts[t]&&this.core.revalidateField(t)}}}}function Z(e,t){t.split(' ').forEach(t=>{e.classList?e.classList.add(t):` ${e.className} `.indexOf(` ${t} `)&&(e.className+=` ${t}`)})}function K(e,t){t.split(' ').forEach(t=>{e.classList?e.classList.remove(t):(e.className=e.className.replace(t,''))})}function $(e,t){let n=[],l=[];Object.keys(t).forEach(e=>{e&&(t[e]?n.push(e):l.push(e))});l.forEach(t=>K(e,t));n.forEach(t=>Z(e,t))}function J(e,t){let n=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector;if(n){return n.call(e,t)}let l=[].slice.call(e.parentElement.querySelectorAll(t));return l.indexOf(e)>=0}function Q(e,t){let n=e;while(n){if(J(n,t)){break}n=n.parentElement}return n}class ee extends q{constructor(e){super(e);this.messages=new Map;this.defaultContainer=document.createElement('div');this.opts=Object.assign({},{container:(e,t)=>this.defaultContainer},e);this.fieldAddedHandler=this.onFieldAdded.bind(this);this.fieldRemovedHandler=this.onFieldRemoved.bind(this);this.validatorValidatedHandler=this.onValidatorValidated.bind(this);this.validatorNotValidatedHandler=this.onValidatorNotValidated.bind(this)}static getClosestContainer(e,t,n){let l=e;while(l){if(l===t){break}l=l.parentElement;if(n.test(l.className)){break}}return l}install(){this.core.getFormElement().appendChild(this.defaultContainer);this.core.on('core.field.added',this.fieldAddedHandler).on('core.field.removed',this.fieldRemovedHandler).on('core.validator.validated',this.validatorValidatedHandler).on('core.validator.notvalidated',this.validatorNotValidatedHandler)}uninstall(){this.core.getFormElement().removeChild(this.defaultContainer);this.messages.forEach(e=>e.parentNode.removeChild(e));this.messages.clear();this.core.off('core.field.added',this.fieldAddedHandler).off('core.field.removed',this.fieldRemovedHandler).off('core.validator.validated',this.validatorValidatedHandler).off('core.validator.notvalidated',this.validatorNotValidatedHandler)}onFieldAdded(e){let t=e.elements;t&&(t.forEach(e=>{let t=this.messages.get(e);t&&(t.parentNode.removeChild(t),this.messages.delete(e))}),this.prepareFieldContainer(e.field,t))}onFieldRemoved(e){if(!e.elements.length||!e.field){return}let t=e.elements[0].getAttribute('type'),n='radio'===t||'checkbox'===t?[e.elements[0]]:e.elements;n.forEach(e=>{if(this.messages.has(e)){let t=this.messages.get(e);t.parentNode.removeChild(t);this.messages.delete(e)}})}prepareFieldContainer(e,t){if(t.length){let n=t[0].getAttribute('type');'radio'===n||'checkbox'===n?this.prepareElementContainer(e,t[0],t):t.forEach(n=>this.prepareElementContainer(e,n,t))}}prepareElementContainer(e,t,n){let l;switch(!0){case 'string'===typeof this.opts.container:let i=this.opts.container;i='#'===i.charAt(0)?`[id="${i.substring(1)}"]`:i;l=this.core.getFormElement().querySelector(i);break;default:l=this.opts.container(e,t);break}let a=document.createElement('div');l.appendChild(a);$(a,{'fv-plugins-message-container':!0});this.core.emit('plugins.message.placed',{element:t,field:e,elements:n,messageElement:a});this.messages.set(t,a)}onValidatorValidated(e){let t=e.elements,n=e.element.getAttribute('type'),l='radio'===n||'checkbox'===n?t[0]:e.element;if(this.messages.has(l)){let t=this.messages.get(l),n=t.querySelector(`[data-field="${e.field}"][data-validator="${e.validator}"]`);if(!n&&!e.result.valid){let n=document.createElement('div');n.innerHTML=e.result.message;n.setAttribute('data-field',e.field);n.setAttribute('data-validator',e.validator);this.opts.clazz&&$(n,{[this.opts.clazz]:!0});t.appendChild(n);this.core.emit('plugins.message.displayed',{element:e.element,field:e.field,message:e.result.message,messageElement:n,meta:e.result.meta,validator:e.validator})}else n&&!e.result.valid?(n.innerHTML=e.result.message,this.core.emit('plugins.message.displayed',{element:e.element,field:e.field,message:e.result.message,messageElement:n,meta:e.result.meta,validator:e.validator})):n&&e.result.valid&&t.removeChild(n)}}onValidatorNotValidated(e){let t=e.elements,n=e.element.getAttribute('type'),l='radio'===n||'checkbox'===n?t[0]:e.element;if(this.messages.has(l)){let t=this.messages.get(l),n=t.querySelector(`[data-field="${e.field}"][data-validator="${e.validator}"]`);n&&t.removeChild(n)}}}class te extends q{constructor(e){super(e);this.results=new Map;this.containers=new Map;this.opts=Object.assign({},{defaultMessageContainer:!0,rowClasses:'',rowValidatingClass:'',eleValidClass:'',eleInvalidClass:''},e);this.elementValidatingHandler=this.onElementValidating.bind(this);this.elementValidatedHandler=this.onElementValidated.bind(this);this.elementNotValidatedHandler=this.onElementNotValidated.bind(this);this.iconPlacedHandler=this.onIconPlaced.bind(this);this.fieldAddedHandler=this.onFieldAdded.bind(this);this.fieldRemovedHandler=this.onFieldRemoved.bind(this)}install(){$(this.core.getFormElement(),{[this.opts.formClass]:!0});this.core.on('core.element.validating',this.elementValidatingHandler).on('core.element.validated',this.elementValidatedHandler).on('core.element.notvalidated',this.elementNotValidatedHandler).on('plugins.icon.placed',this.iconPlacedHandler).on('core.field.added',this.fieldAddedHandler).on('core.field.removed',this.fieldRemovedHandler);this.opts.defaultMessageContainer&&this.core.registerPlugin('___frameworkMessage',new ee({clazz:this.opts.messageClass,container:(e,t)=>{let n='string'===typeof this.opts.rowSelector?this.opts.rowSelector:this.opts.rowSelector(e,t),l=Q(t,n);return ee.getClosestContainer(t,l,this.opts.rowPattern)}}))}uninstall(){this.results.clear();this.containers.clear();$(this.core.getFormElement(),{[this.opts.formClass]:!1});this.core.off('core.element.validating',this.elementValidatingHandler).off('core.element.validated',this.elementValidatedHandler).off('core.element.notvalidated',this.elementNotValidatedHandler).off('plugins.icon.placed',this.iconPlacedHandler).off('core.field.added',this.fieldAddedHandler).off('core.field.removed',this.fieldRemovedHandler)}onIconPlaced(e){}onFieldAdded(e){let t=e.elements;t&&(t.forEach(e=>{let t=this.containers.get(e);t&&($(t,{[this.opts.rowInvalidClass]:!1,[this.opts.rowValidatingClass]:!1,[this.opts.rowValidClass]:!1,'fv-plugins-icon-container':!1}),this.containers.delete(e))}),this.prepareFieldContainer(e.field,t))}onFieldRemoved(e){e.elements.forEach(e=>{let t=this.containers.get(e);t&&$(t,{[this.opts.rowInvalidClass]:!1,[this.opts.rowValidatingClass]:!1,[this.opts.rowValidClass]:!1})})}prepareFieldContainer(e,t){if(t.length){let n=t[0].getAttribute('type');'radio'===n||'checkbox'===n?this.prepareElementContainer(e,t[0]):t.forEach(t=>this.prepareElementContainer(e,t))}}prepareElementContainer(e,t){let n='string'===typeof this.opts.rowSelector?this.opts.rowSelector:this.opts.rowSelector(e,t),l=Q(t,n);l!==t&&($(l,{[this.opts.rowClasses]:!0,'fv-plugins-icon-container':!0}),this.containers.set(t,l))}onElementValidating(e){let t=e.elements,n=e.element.getAttribute('type'),l='radio'===n||'checkbox'===n?t[0]:e.element,i=this.containers.get(l);i&&$(i,{[this.opts.rowInvalidClass]:!1,[this.opts.rowValidatingClass]:!0,[this.opts.rowValidClass]:!1})}onElementNotValidated(e){let t=e.elements,n=e.element.getAttribute('type'),l='radio'===n||'checkbox'===n?t[0]:e.element,i=this.containers.get(l);i&&$(i,{[this.opts.rowInvalidClass]:!1,[this.opts.rowValidatingClass]:!1,[this.opts.rowValidClass]:!1})}onElementValidated(e){let t=e.elements,n=e.element.getAttribute('type'),l='radio'===n||'checkbox'===n?t[0]:e.element;$(l,{[this.opts.eleValidClass]:e.valid,[this.opts.eleInvalidClass]:!e.valid});let i=this.containers.get(l);if(i){if(!e.valid)this.results.set(l,!1),$(i,{[this.opts.rowInvalidClass]:!0,[this.opts.rowValidatingClass]:!1,[this.opts.rowValidClass]:!1});else{this.results.delete(l);let e=!0;this.containers.forEach((t,n)=>{t===i&&this.results.get(n)===!1&&(e=!1)});e&&$(i,{[this.opts.rowInvalidClass]:!1,[this.opts.rowValidatingClass]:!1,[this.opts.rowValidClass]:!0})}}}}class ne extends q{constructor(e){super(e);this.icons=new Map;this.opts=Object.assign({},{invalid:'fv-plugins-icon--invalid',valid:'fv-plugins-icon--valid',validating:'fv-plugins-icon--validating',onPlaced:()=>{},onSet:()=>{}},e);this.elementValidatingHandler=this.onElementValidating.bind(this);this.elementValidatedHandler=this.onElementValidated.bind(this);this.elementNotValidatedHandler=this.onElementNotValidated.bind(this);this.fieldAddedHandler=this.onFieldAdded.bind(this)}install(){this.core.on('core.element.validating',this.elementValidatingHandler).on('core.element.validated',this.elementValidatedHandler).on('core.element.notvalidated',this.elementNotValidatedHandler).on('core.field.added',this.fieldAddedHandler)}uninstall(){this.icons.forEach(e=>e.parentNode.removeChild(e));this.icons.clear();this.core.off('core.element.validating',this.elementValidatingHandler).off('core.element.validated',this.elementValidatedHandler).off('core.element.notvalidated',this.elementNotValidatedHandler).off('core.field.added',this.fieldAddedHandler)}onFieldAdded(e){let t=e.elements;t&&(t.forEach(e=>{let t=this.icons.get(e);t&&(t.parentNode.removeChild(t),this.icons.delete(e))}),this.prepareFieldIcon(e.field,t))}prepareFieldIcon(e,t){if(t.length){let n=t[0].getAttribute('type');'radio'===n||'checkbox'===n?this.prepareElementIcon(e,t[0]):t.forEach(t=>this.prepareElementIcon(e,t))}}prepareElementIcon(e,t){let n=document.createElement('i');n.setAttribute('data-field',e);t.parentNode.insertBefore(n,t.nextSibling);$(n,{'fv-plugins-icon':!0});let l={classes:{invalid:this.opts.invalid,valid:this.opts.valid,validating:this.opts.validating},element:t,field:e,iconElement:n};this.core.emit('plugins.icon.placed',l);this.opts.onPlaced(l);this.icons.set(t,n)}onElementValidating(e){let t=this.setClasses(e.field,e.element,e.elements,{[this.opts.invalid]:!1,[this.opts.valid]:!1,[this.opts.validating]:!0}),n={element:e.element,field:e.field,status:s.Validating,iconElement:t};this.core.emit('plugins.icon.set',n);this.opts.onSet(n)}onElementValidated(e){let t=this.setClasses(e.field,e.element,e.elements,{[this.opts.invalid]:!e.valid,[this.opts.valid]:e.valid,[this.opts.validating]:!1}),n={element:e.element,field:e.field,status:e.valid?s.Valid:s.Invalid,iconElement:t};this.core.emit('plugins.icon.set',n);this.opts.onSet(n)}onElementNotValidated(e){let t=this.setClasses(e.field,e.element,e.elements,{[this.opts.invalid]:!1,[this.opts.valid]:!1,[this.opts.validating]:!1}),n={element:e.element,field:e.field,status:s.NotValidated,iconElement:t};this.core.emit('plugins.icon.set',n);this.opts.onSet(n)}setClasses(e,t,n,l){let i=t.getAttribute('type'),a='radio'===i||'checkbox'===i?n[0]:t;if(this.icons.has(a)){let e=this.icons.get(a);$(e,l);return e}else{return null}}}class le extends q{constructor(e){super(e);this.opts=Object.assign({},{selector:'[type="submit"]:not([formnovalidate])'},e);this.submitHandler=this.submitHandle.bind(this)}install(){if(!(this.core.getFormElement() instanceof HTMLFormElement)){return}let e=this.core.getFormElement();e.setAttribute('novalidate','novalidate');e.addEventListener('submit',this.submitHandler);let t=document.createElement('button');t.setAttribute('type','submit');Object.assign(t.style,{display:'none',height:'0',width:'0'});e.appendChild(t);let n=[].slice.call(e.querySelectorAll(this.opts.selector)),l=[].slice.call(e.querySelectorAll('[type="submit"]'));l.forEach(l=>{l.addEventListener('click',l=>{let i=l.currentTarget;if(!l.defaultPrevented&&i instanceof HTMLElement&&n.indexOf(i)===-1&&i!==t){e.removeEventListener('submit',this.submitHandler);e.submit();return!1}})})}uninstall(){let e=this.core.getFormElement();e instanceof HTMLFormElement&&e.removeEventListener('submit',this.submitHandler)}submitHandle(e){e.preventDefault();this.core.validate()}}class ie extends q{constructor(e){super(e);this.messages=new Map;this.opts=Object.assign({},{placement:'top',trigger:'click'},e);this.iconPlacedHandler=this.onIconPlaced.bind(this);this.validatorValidatedHandler=this.onValidatorValidated.bind(this);this.elementValidatedHandler=this.onElementValidated.bind(this);this.documentClickHandler=this.onDocumentClicked.bind(this)}install(){this.tip=document.createElement('div');$(this.tip,{'fv-plugins-tooltip':!0,[`fv-plugins-tooltip--${this.opts.placement}`]:!0});document.body.appendChild(this.tip);this.core.on('plugins.icon.placed',this.iconPlacedHandler).on('core.validator.validated',this.validatorValidatedHandler).on('core.element.validated',this.elementValidatedHandler);'click'===this.opts.trigger&&document.addEventListener('click',this.documentClickHandler)}uninstall(){this.messages.clear();document.body.removeChild(this.tip);this.core.off('plugins.icon.placed',this.iconPlacedHandler).off('core.validator.validated',this.validatorValidatedHandler).off('core.element.validated',this.elementValidatedHandler);'click'===this.opts.trigger&&document.removeEventListener('click',this.documentClickHandler)}onIconPlaced(e){$(e.iconElement,{'fv-plugins-tooltip-icon':!0});switch(this.opts.trigger){case 'hover':e.iconElement.addEventListener('mouseenter',t=>this.show(e.element,t));e.iconElement.addEventListener('mouseleave',e=>this.hide());break;case 'click':;default:e.iconElement.addEventListener('click',t=>this.show(e.element,t));break}}onValidatorValidated(e){if(!e.result.valid){let t=e.elements,n=e.element.getAttribute('type'),l='radio'===n||'checkbox'===n?t[0]:e.element;this.messages.set(l,e.result.message)}}onElementValidated(e){if(e.valid){let t=e.elements,n=e.element.getAttribute('type'),l='radio'===n||'checkbox'===n?t[0]:e.element;this.messages.delete(l)}}onDocumentClicked(e){this.hide()}show(e,t){t.preventDefault();t.stopPropagation();if(!this.messages.has(e)){return}$(this.tip,{'fv-plugins-tooltip--hide':!1});this.tip.innerHTML=`<span class="fv-plugins-tooltip__content">${this.messages.get(e)}</span>`;let n=t.target,l=n.getBoundingClientRect(),i=0,a=0;switch(this.opts.placement){case 'top':;default:i=l.top-l.height;a=l.left+l.width/2-this.tip.clientWidth/2;break;case 'top-left':i=l.top-l.height;a=l.left;break;case 'top-right':i=l.top-l.height;a=l.left+l.width-this.tip.clientWidth;break;case 'bottom':i=l.top+l.height;a=l.left+l.width/2-this.tip.clientWidth/2;break;case 'bottom-left':i=l.top+l.height;a=l.left;break;case 'bottom-right':i=l.top+l.height;a=l.left+l.width-this.tip.clientWidth;break;case 'left':i=l.top+l.height/2-this.tip.clientHeight/2;a=l.left-this.tip.clientWidth;break;case 'right':i=l.top+l.height/2-this.tip.clientHeight/2;a=l.left+l.width;break}i+=document.body.scrollTop;a+=document.body.scrollLeft;this.tip.setAttribute('style',`top: ${i}px; left: ${a}px`)}hide(){$(this.tip,{'fv-plugins-tooltip--hide':!0})}}class ae extends q{constructor(e){super(e);this.handlers=[];this.ieVersion=(()=>{let e=3,t=document.createElement('div'),n=t.all||[];while(t.innerHTML='<!--[if gt IE '+ ++e+']><br><![endif]-->', n[0]);;return e>4?e:document.documentMode})();let t=document.createElement('div');this.defaultEvent=this.ieVersion===9||!('oninput' in t)?'keyup':'input';this.opts=Object.assign({},{event:this.defaultEvent,threshold:0},e);this.fieldAddedHandler=this.onFieldAdded.bind(this);this.fieldRemovedHandler=this.onFieldRemoved.bind(this)}install(){this.core.on('core.field.added',this.fieldAddedHandler).on('core.field.removed',this.fieldRemovedHandler)}uninstall(){this.handlers.forEach(e=>e.element.removeEventListener(e.event,e.handler));this.handlers=[];this.core.off('core.field.added',this.fieldAddedHandler).off('core.field.removed',this.fieldRemovedHandler)}prepareHandler(e,t){t.forEach(t=>{let n=[];switch(!0){case !!this.opts.event&&this.opts.event[e]===!1:n=[];break;case !!this.opts.event&&!!this.opts.event[e]:n=this.opts.event[e].split(' ');break;case 'string'===typeof this.opts.event&&this.opts.event!==this.defaultEvent:n=this.opts.event.split(' ');break;default:let a=t.getAttribute('type');let i=t.tagName.toLowerCase();let l='radio'===a||'checkbox'===a||'file'===a||'select'===i?'change':(this.ieVersion>=10&&t.getAttribute('placeholder')?'keyup':this.defaultEvent);n=[l];break}n.forEach(n=>{let l=n=>this.handleEvent(n,e,t);this.handlers.push({element:t,event:n,field:e,handler:l});t.addEventListener(n,l)})})}handleEvent(e,t,n){this.exceedThreshold(t,n)&&this.core.validateElement(t,n).then(l=>{this.core.emit('plugins.trigger.executed',{element:n,event:e,field:t})})}onFieldAdded(e){this.handlers.filter(t=>t.field===e.field).forEach(e=>e.element.removeEventListener(e.event,e.handler));this.prepareHandler(e.field,e.elements)}onFieldRemoved(e){this.handlers.filter(t=>t.field===e.field&&e.elements.indexOf(t.element)>=0).forEach(e=>e.element.removeEventListener(e.event,e.handler))}exceedThreshold(e,t){let n=this.opts.threshold[e]===0||this.opts.threshold===0?!1:this.opts.threshold[e]||this.opts.threshold;if(!n){return!0}let l=t.getAttribute('type');if(['button','checkbox','file','hidden','image','radio','reset','submit'].indexOf(l)!==-1){return!0}let i=this.core.getElementValue(e,t);return i.length>=n}}var re={Alias:j,Aria:X,AutoFocus:G,Declarative:U,DefaultSubmit:W,Dependency:B,Framework:te,Icon:ne,Message:ee,SubmitButton:le,Tooltip:ie,Trigger:ae};function oe(e,t){return e.classList?e.classList.contains(t):new RegExp(`(^| )${t}( |$)`,'gi').test(e.className)}var se={call:f,classSet:$,closest:Q,fetch:M,format:c,hasClass:oe,isValidDate:b};let de={};e.algorithms=i;e.formValidation=P;e.filters=_;e.locales=de;e.plugins=re;e.utils=se;e.validators=z;e.Plugin=q;e.Status=s;Object.defineProperty(e,'__esModule',{value:!0})}))
