!function(e,t){typeof exports==='object'&&typeof module!=='undefined'?module.exports=t():typeof define==='function'&&define.amd?define(t):(e.FormValidation=e.FormValidation||{}, e.FormValidation.plugins=e.FormValidation.plugins||{}, e.FormValidation.plugins.Recaptcha=t())}(this,(function(){"use strict";var e=FormValidation.Plugin,t;!function(e){e.Invalid="Invalid";e.NotValidated="NotValidated";e.Valid="Valid";e.Validating="Validating"}(t||(t={}));var i=t;class a extends e{constructor(e){super(e);this.widgetIds=new Map;this.opts=Object.assign({},a.DEFAULT_OPTIONS,e);this.fieldResetHandler=this.onResetField.bind(this)}install(){this.core.on('core.field.reset',this.fieldResetHandler);let e=typeof window[a.LOADED_CALLBACK]==='undefined'?()=>{}:window[a.LOADED_CALLBACK];window[a.LOADED_CALLBACK]=()=>{e();let t={callback:e=>{this.core.updateFieldStatus(a.CAPTCHA_FIELD,i.Valid),setTimeout(()=>{this.core.updateFieldStatus(a.CAPTCHA_FIELD,i.Invalid)},this.opts.timeout*1e3)},sitekey:this.opts.siteKey,stoken:this.opts.secureToken||null,theme:this.opts.theme},l=window.grecaptcha.render(this.opts.element,t);this.widgetIds.set(this.opts.element,l);setTimeout(()=>{this.core.addField(a.CAPTCHA_FIELD,{validators:{callback:{callback:e=>{return e.value!==''},message:this.opts.message}}})},3e3)};let t=this.getScript();if(!document.body.querySelector(`script[src="${t}"]`)){let e=document.createElement('script');e.type='text/javascript';e.async=!0;e.defer=!0;e.src=t;document.body.appendChild(e)}}uninstall(){this.core.off('core.field.reset',this.fieldResetHandler);this.widgetIds.clear();let e=this.getScript(),t=[].slice.call(document.body.querySelectorAll(`script[src="${e}"]`));t.forEach(e=>e.parentNode.removeChild(e));this.core.removeField(a.CAPTCHA_FIELD)}getScript(){let e=this.opts.language?`&hl=${this.opts.language}`:'';return`https://www.google.com/recaptcha/api.js?onload=${a.LOADED_CALLBACK}&render=explicit${e}`}onResetField(e){if(e.field===a.CAPTCHA_FIELD&&this.widgetIds.has(this.opts.element)){let e=this.widgetIds.get(this.opts.element);window.grecaptcha.reset(e)}}}a.DEFAULT_ID='Recaptcha';a.CAPTCHA_FIELD='g-recaptcha-response';a.DEFAULT_OPTIONS={theme:'light',timeout:120};a.LOADED_CALLBACK='___reCaptchaLoaded___';return a}))